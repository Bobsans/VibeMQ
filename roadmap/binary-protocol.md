# Бинарный протокол

**Описание:** Альтернативный бинарный формат для повышения производительности.

**Детальный план:**

## Шаг 1: Выбор формата
**Задачи:**
1. Выбрать формат: MessagePack, Protobuf, или Custom
2. Сравнить производительность и размер
3. Определить требования к схемам

## Шаг 2: Проектирование протокола
**Задачи:**
1. Определить negotiation механизм (в Connect команде)
2. Определить формат бинарных фреймов
3. Определить маппинг команд на бинарный формат

## Шаг 3: Реализация бинарного кодера
**Файл:** `src/VibeMQ.Protocol/Binary/IBinaryCodec.cs`
**Файл:** `src/VibeMQ.Protocol.Binary.MessagePack/MessagePackCodec.cs`

**Задачи:**
1. Создать интерфейс `IBinaryCodec`
2. Реализовать кодек для выбранного формата
3. Сериализация/десериализация `ProtocolMessage`

## Шаг 4: Интеграция в протокол
**Файл:** `src/VibeMQ.Protocol/Framing/FrameReader.cs`
**Файл:** `src/VibeMQ.Protocol/Framing/FrameWriter.cs`

**Задачи:**
1. Обновить `FrameWriter` для поддержки бинарного формата
2. Обновить `FrameReader` для определения формата (JSON vs Binary)
3. Negotiation при подключении

## Шаг 5: Обновление клиента и сервера
**Файл:** `src/VibeMQ.Client/VibeMQClient.cs`
**Файл:** `src/VibeMQ.Server/Handlers/ConnectHandler.cs`

**Задачи:**
1. Поддержка negotiation на клиенте
2. Поддержка negotiation на сервере
3. Переключение между форматами

## Шаг 6: Тестирование
**Задачи:**
1. Тесты сериализации/десериализации
2. Тесты совместимости с JSON протоколом
3. Performance тесты (сравнение с JSON)
